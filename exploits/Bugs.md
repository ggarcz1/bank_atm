# Bugs and Exploits

#### Bug #1

Traversal to a user without authentication:
<http://127.0.0.1:5000/user/{username}>
User enumeration of a URL
Bruteforce of usernames of this address and an apprpriate response.  Any request that comes back with "ERROR:" in the response.text field is not a valid user.

See **bug_1.py** for exploit

#### Bug #2

all users are valid using bug#1, there is no check for this --> further development of the backend database.  
Fixed --> check is made in the "username" field for if the user exists in the database

#### Bug #3

Username is present at the end of the URL

<http://127.0.0.1:5000/user/{username}>

Added session['user'] = username
removed passing of variable 'username' directly into the method to load and compare logon data
@app.route('**/user/{username}**', methods=['GET', 'POST']) --> @app.route('**/user**', methods=['GET', 'POST'])
def logged_in **(username)**: --> def logged_in **()**:

#### Bug #4

admin admin logon results in "hello John"
in the method **get_account_details**
{'first_name':'John',
'last_name':'Doe',
...
}

testing return value was updated to:
    account_details = {'first_name':'FirstName',
                       'last_name':'LastName',
                       'balance': 23344.12,
                       'email':'<email@domain.com>',
                       'account_number': '12345678',
                       'zipcode': 12345}

#### Bug #5

Unencrypted communications (HTTP)

![Bug#5 Http](https://github.com/ggarcz1/bank_atm/blob/main/exploits/Bug%235/Bug%235.png?raw=true)
Path: exploits\Bug#5\Bug#5.png

#### Bug #6

Weak Encryption SHA256

Simple hashing of PIN when entered into the ATM.
PINs are 4 digits, 0-9 from 0000-9999, and of string values.
In the file **atm.py**
    sha256_hash = hashlib.sha256()
    sha256_hash.update(entered_pin.encode('utf-8'))
    hashed_pin = sha256_hash.hexdigest()
    print(hashed_pin)
    verify_pin(hashed_pin)

Can be changed to add

1. Salting/Peppering
2. Another pseudo-random value, possibily utilizing time and date


#### Bug #7
Traversal to a user without authentication:
<http://127.0.0.1:5000/account>

yeilds an admin page.

![alt text](images/admin_page_1.png)
